"use strict";(self["webpackChunkeden"]=self["webpackChunkeden"]||[]).push([[495],{2495:function(t,e,a){a.r(e),a.d(e,{default:function(){return gt}});var s=a(6252),i=a(9963),o=a(3577);const l={class:"container py-5"},d=(0,s.uE)('<div class="mb-5 row justify-content-center"><div class="col col-md-10 col-lg-8"><ul class="row justify-content-center list-unstyled"><li class="col text-center position-relative"><div class="text-primary fw-bold">購物車</div><div class="step-bar bg-secondary"></div><div class="step-circle bg-primary"><span>1</span></div></li><li class="col text-center position-relative"><div class="text-secondary">建立訂單</div><div class="step-bar bg-secondary"></div><div class="step-circle bg-secondary mx-auto"><span>2</span></div></li><li class="col text-center position-relative"><div class="text-secondary">付款</div><div class="step-bar bg-secondary"></div><div class="step-circle bg-secondary mx-auto"><span>3</span></div></li><li class="col text-center"><div class="text-secondary">付款完成</div><div class="step-circle bg-secondary mx-auto"><span>4</span></div></li></ul></div></div>',1),n={key:0,class:"my-5 text-center"},c=(0,s._)("h5",null,"購物車裡沒有東西！快去逛逛吧！！",-1),r=(0,s.Uk)(" 去逛逛 "),p={key:1,class:"my-5"},u={class:"row"},h={class:"col-lg-8"},g={class:"d-md-none"},b=["onClick","disabled"],m=(0,s._)("i",{class:"bi bi-x fs-2"},null,-1),v=[m],_={class:"fw-bold"},y={class:"input-group input-group-sm my-2",style:{width:"80px"}},C=["disabled","onClick"],w=["onUpdate:modelValue","onChange"],x=["disabled","onClick"],f={key:0,class:"text-danger"},k={key:1},$={class:"text-danger ms-2"},L={class:"d-none d-md-table table table-responsive-md align-middle"},D=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{class:"text-center"},"單價"),(0,s._)("th",{style:{width:"100px"}},"數量"),(0,s._)("th",{class:"text-end"},"合計")])],-1),M=["onClick","disabled"],z=(0,s._)("i",{class:"bi bi-trash3-fill text-danger fs-5"},null,-1),q=[z],I={class:"fw-bold"},S={class:"text-center"},U={key:0,class:"text-danger"},j={key:1},W={class:"text-danger"},V={class:"input-group input-group-sm mb-2"},H=["disabled","onClick"],B=["onUpdate:modelValue","onChange"],Y=["disabled","onClick"],E={class:"text-end text-danger"},K=["disabled"],Z={class:"col-lg-4 mt-4 mt-lg-0"},F={class:"text-end shadow p-3 p-lg-5"},O={class:"d-flex justify-content-between"},P=(0,s._)("span",null,"總計：",-1),A={key:0,class:"text-danger d-flex justify-content-between"},G=(0,s._)("span",null,"優惠券折扣：",-1),J={key:1,class:"text-end"},N={class:"text-danger"},Q={class:"d-flex justify-content-between"},R=(0,s._)("span",null,"折扣價：",-1),T={class:"fw-bold"},X={class:"input-group my-3 input-group-sm"},tt={class:"input-group-append"},et=["disabled"],at={class:"modal fade",id:"clearCartModal",tabindex:"-1","aria-labelledby":"clearCartModalLabel","aria-hidden":"true"},st={class:"modal-dialog"},it={class:"modal-content border-0"},ot=(0,s._)("div",{class:"modal-header bg-danger text-white"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},"確定清空購物車?"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),lt=(0,s._)("div",{class:"modal-body"}," 清空後將無法回復喔！ ",-1),dt={class:"modal-footer"},nt=(0,s._)("button",{type:"button",class:"btn btn-outline-danger","data-bs-dismiss":"modal"},"取消",-1);function ct(t,e,a,m,z,ct){const rt=(0,s.up)("Loading-component"),pt=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(rt,{active:z.isLoading},null,8,["active"]),(0,s._)("div",l,[d,0==z.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",n,[c,(0,s.Wm)(pt,{to:"/products",class:"btn standardBtn"},{default:(0,s.w5)((()=>[r])),_:1})])):((0,s.wg)(),(0,s.iD)("div",p,[(0,s._)("div",u,[(0,s._)("div",h,[(0,s._)("div",g,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(z.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id,class:"d-flex py-2 mb-4 border-bottom position-relative"},[(0,s._)("a",{href:"#",class:"position-absolute end-0",onClick:(0,i.iM)((e=>ct.removeCartItem(t.id)),["prevent"]),disabled:z.isLoading},v,8,b),(0,s.Wm)(pt,{to:`/product/${t.product.id}`},{default:(0,s.w5)((()=>[(0,s._)("div",{class:"img-cover me-3",style:(0,o.j5)([{width:"100px",height:"120px"},`background-image: url('${t.product.imageUrl}')`])},null,4)])),_:2},1032,["to"]),(0,s._)("div",null,[(0,s._)("div",_,[(0,s.Wm)(pt,{to:`/product/${t.product.id}`},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(t.product.title),1)])),_:2},1032,["to"])]),(0,s._)("small",null,(0,o.zw)(t.product.description),1),(0,s._)("div",y,[(0,s._)("button",{class:"btn btn-secondary text-white",type:"button",disabled:z.isLoading,onClick:e=>ct.updateCartItem(t,-1)}," - ",8,C),(0,s.wy)((0,s._)("input",{type:"number",onkeypress:"return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57",class:"form-control text-center","onUpdate:modelValue":e=>t.qty=e,onChange:e=>ct.updateCartItem(t,0)},null,40,w),[[i.nr,t.qty,void 0,{number:!0}]]),(0,s._)("button",{class:"btn btn-secondary text-white",type:"button",disabled:z.isLoading,onClick:e=>ct.updateCartItem(t,1)}," + ",8,x)]),(0,s._)("div",null,[t.product.price===t.product.origin_price?((0,s.wg)(),(0,s.iD)("div",f,(0,o.zw)(t.product.price*t.qty)+" 元 ",1)):((0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("small",null,[(0,s._)("del",null,(0,o.zw)(t.product.origin_price*t.qty)+" 元",1)]),(0,s._)("span",$,(0,o.zw)(t.product.price*t.qty)+" 元",1)]))])])])))),128))]),(0,s._)("table",L,[D,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(z.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-sm",onClick:e=>ct.removeCartItem(t.id),disabled:z.isLoading},q,8,M)]),(0,s._)("td",null,[(0,s.Wm)(pt,{to:`/product/${t.product.id}`,class:"link-dark d-md-flex align-items-center"},{default:(0,s.w5)((()=>[(0,s._)("div",{class:"img-cover me-3",style:(0,o.j5)([{width:"100px",height:"100px"},`background-image: url('${t.product.imageUrl}')`])},null,4),(0,s._)("div",null,[(0,s._)("p",I,(0,o.zw)(t.product.title),1),(0,s._)("small",null,(0,o.zw)(t.product.description),1)])])),_:2},1032,["to"])]),(0,s._)("td",S,[t.product.price===t.product.origin_price?((0,s.wg)(),(0,s.iD)("div",U,(0,o.zw)(t.product.price)+" 元 ",1)):((0,s.wg)(),(0,s.iD)("div",j,[(0,s._)("small",null,[(0,s._)("del",null,(0,o.zw)(t.product.origin_price)+" 元",1)]),(0,s._)("div",W,(0,o.zw)(t.product.price)+" 元",1)]))]),(0,s._)("td",null,[(0,s._)("div",V,[(0,s._)("button",{class:"btn btn-secondary text-white",type:"button",disabled:z.isLoading,onClick:e=>ct.updateCartItem(t,-1)}," - ",8,H),(0,s.wy)((0,s._)("input",{type:"number",onkeypress:"return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57",class:"form-control text-center","onUpdate:modelValue":e=>t.qty=e,onChange:e=>ct.updateCartItem(t,0)},null,40,B),[[i.nr,t.qty,void 0,{number:!0}]]),(0,s._)("button",{class:"btn btn-secondary text-white",type:"button",disabled:z.isLoading,onClick:e=>ct.updateCartItem(t,1)}," + ",8,Y)])]),(0,s._)("td",E,(0,o.zw)(t.total)+" 元 ",1)])))),128))])]),(0,s._)("div",null,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button","data-bs-toggle":"modal","data-bs-target":"#clearCartModal",disabled:0===z.cartData.carts.length}," 清空購物車 ",8,K)])]),(0,s._)("div",Z,[(0,s._)("div",F,[(0,s._)("p",O,[P,(0,s._)("span",null,(0,o.zw)(t.$filters.currency(z.cartData.total))+" 元",1)]),z.cartData.carts[0].coupon?((0,s.wg)(),(0,s.iD)("p",A,[G,(0,s._)("span",null,"- "+(0,o.zw)(z.cartData.total-Math.floor(z.cartData.final_total))+" 元",1)])):(0,s.kq)("",!0),z.cartData.carts[0].coupon?((0,s.wg)(),(0,s.iD)("p",J,[(0,s._)("small",N," (已套用「"+(0,o.zw)(z.cartData.carts[0].coupon.title)+"」優惠券："+(0,o.zw)(z.cartData.carts[0].coupon.code)+") ",1)])):(0,s.kq)("",!0),(0,s._)("p",Q,[R,(0,s._)("span",T,(0,o.zw)(t.$filters.currency(Math.floor(z.cartData.final_total)))+" 元",1)]),(0,s._)("div",X,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>z.couponCode=t),placeholder:"請輸入優惠碼",ref:"couponCode"},null,512),[[i.nr,z.couponCode]]),(0,s._)("div",tt,[(0,s._)("button",{class:"btn standardBtn text-white",type:"button",onClick:e[1]||(e[1]=(...t)=>ct.addCouponCode&&ct.addCouponCode(...t))}," 套用 ")])]),(0,s.Wm)(pt,{to:"/order"},{default:(0,s.w5)((()=>[(0,s._)("button",{class:"btn standardBtn w-100",type:"button",disabled:0===z.cartData.carts.length}," 填寫訂單 ",8,et)])),_:1})])])])]))]),(0,s._)("div",at,[(0,s._)("div",st,[(0,s._)("div",it,[ot,lt,(0,s._)("div",dt,[nt,(0,s._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:e[2]||(e[2]=(...t)=>ct.clearCart&&ct.clearCart(...t))},"忍痛清空")])])])])],64)}var rt=a(4902),pt={data(){return{cartData:{carts:[]},products:[],product:{},couponCode:"",isLoading:!1,form:{user:{email:"",name:"",tel:"",address:""},message:""}}},methods:{getCart(){this.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ycl/cart").then((t=>{this.cartData=t.data.data,rt.Z.emit("get-cart"),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息"),this.isLoading=!1}))},removeCartItem(t){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ycl/cart/${t}`).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.getCart(),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"移除購物車品項"),this.isLoading=!1}))},updateCartItem(t,e){if(t.qty+e===0)return void this.removeCartItem(t.id);if(t.qty+e<1||t.qty%1!==0)return void this.emitter.emit("push-message",{style:"success",title:"錯誤訊息",content:"輸入數量錯誤"});const a={product_id:t.id,qty:t.qty+e};this.isLoading=!0,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ycl/cart/${t.id}`,{data:a}).then((t=>{this.$httpMessageState(t,"更新購物車"),this.getCart(),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"更新購物車"),this.isLoading=!1}))},clearCart(){this.isLoading=!0,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/ycl/carts").then((t=>{this.$httpMessageState(t,"清空購物車"),this.getCart(),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"清空購物車"),this.isLoading=!1}))},addCouponCode(){this.isLoading=!0;const t={code:this.couponCode};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ycl/coupon",{data:t}).then((t=>{this.$httpMessageState(t,"套用優惠券"),this.couponCode="",this.getCart(),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"套用優惠券"),this.couponCode="",this.isLoading=!1}))},createOrder(){this.isLoading=!0;const t={data:this.form};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ycl/order",t).then((t=>{this.$httpMessageState(t,"送出訂單"),this.$refs.form.resetForm(),this.form.message="",this.$router.push(`/checkout/${t.data.orderId}`),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"送出訂單"),this.isLoading=!1}))},isPhone(t){const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"電話格式錯誤"}},mounted(){document.title="Eden Handmade | 購物袋",this.getCart()}},ut=a(3744);const ht=(0,ut.Z)(pt,[["render",ct]]);var gt=ht}}]);
//# sourceMappingURL=495.6debec16.js.map
"use strict";(self["webpackChunkeden"]=self["webpackChunkeden"]||[]).push([[750],{6750:function(t,e,o){o.r(e),o.d(e,{default:function(){return F}});var n=o(6252),a=o(3577);const s={class:"container my-5"},l=(0,n._)("h1",{class:"text-secondary"},"優惠券管理",-1),i={class:"text-end mt-3"},p={class:"table mt-4"},d=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"名稱"),(0,n._)("th",null,"折扣百分比"),(0,n._)("th",null,"到期日"),(0,n._)("th",null,"是否啟用"),(0,n._)("th",null,"編輯")])],-1),u={key:0,class:"text-success"},c={key:1,class:"text-muted"},r={class:"btn-group"},m=["onClick"],h=["onClick"];function g(t,e,o,g,b,_){const C=(0,n.up)("Loading-component"),y=(0,n.up)("pagination-component"),v=(0,n.up)("coupon-modal"),f=(0,n.up)("delete-modal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(C,{active:b.isLoading},null,8,["active"]),(0,n._)("div",s,[l,(0,n._)("div",i,[(0,n._)("button",{class:"btn btn-primary",type:"button","data-bs-toggle":"modal","data-bs-target":"#couponModal",onClick:e[0]||(e[0]=t=>b.tempCoupon={due_date:(new Date).getTime()/1e3,is_enabled:0})}," 建立新的優惠券 ")]),(0,n._)("table",p,[d,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(b.coupons,((e,o)=>((0,n.wg)(),(0,n.iD)("tr",{key:o},[(0,n._)("td",null,(0,a.zw)(e.title),1),(0,n._)("td",null,(0,a.zw)(e.percent)+"%",1),(0,n._)("td",null,(0,a.zw)(t.$filters.date(e.due_date)),1),(0,n._)("td",null,[1===e.is_enabled?((0,n.wg)(),(0,n.iD)("span",u,"啟用")):((0,n.wg)(),(0,n.iD)("span",c,"未啟用"))]),(0,n._)("td",null,[(0,n._)("div",r,[(0,n._)("button",{type:"button",class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#couponModal",onClick:t=>_.openCouponModal(e)}," 編輯 ",8,m),(0,n._)("button",{type:"button",class:"btn btn-outline-danger btn-sm","data-bs-toggle":"modal","data-bs-target":"#deleteModal",onClick:t=>_.openDeleteModal(e)}," 刪除 ",8,h)])])])))),128))])]),(0,n.Wm)(y,{pages:b.pagination,onGetItems:_.getCoupons},null,8,["pages","onGetItems"])]),(0,n.Wm)(v,{coupon:b.tempCoupon,"current-page":b.currentPage,ref:"CouponModal",onGetCoupons:_.getCoupons},null,8,["coupon","current-page","onGetCoupons"]),(0,n.Wm)(f,{item:b.tempCoupon,ref:"deleteModal",onDeleteItem:_.deleteCoupon},null,8,["item","onDeleteItem"])],64)}var b=o(9963);const _={class:"modal fade",id:"couponModal",tabindex:"-1",ref:"couponModal"},C={class:"modal-dialog",role:"document"},y={class:"modal-content"},v={class:"modal-header bg-primary text-white"},f={class:"modal-title",id:"exampleModalLabel"},w={key:0},M={key:1},k=(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body"},$={class:"mb-3"},x=(0,n._)("label",{for:"title"},"標題",-1),L={class:"mb-3"},S=(0,n._)("label",{for:"coupon_code"},"優惠碼",-1),P={class:"mb-3"},I=(0,n._)("label",{for:"due_date"},"到期日",-1),U={class:"mb-3"},V=(0,n._)("label",{for:"price"},"折扣百分比",-1),G={class:"mb-3"},W={class:"form-check"},Z=(0,n._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),z={class:"modal-footer"},O=(0,n._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"}," 取消 ",-1);function H(t,e,o,a,s,l){return(0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("div",C,[(0,n._)("div",y,[(0,n._)("div",v,[(0,n._)("h5",f,[s.tempCoupon.id?((0,n.wg)(),(0,n.iD)("span",w,"編輯優惠券")):((0,n.wg)(),(0,n.iD)("span",M,"新增優惠券"))]),k]),(0,n._)("div",D,[(0,n._)("div",$,[x,(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[0]||(e[0]=t=>s.tempCoupon.title=t),placeholder:"請輸入標題"},null,512),[[b.nr,s.tempCoupon.title]])]),(0,n._)("div",L,[S,(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":e[1]||(e[1]=t=>s.tempCoupon.code=t),placeholder:"請輸入優惠碼"},null,512),[[b.nr,s.tempCoupon.code]])]),(0,n._)("div",P,[I,(0,n.wy)((0,n._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":e[2]||(e[2]=t=>s.due_date=t)},null,512),[[b.nr,s.due_date]])]),(0,n._)("div",U,[V,(0,n.wy)((0,n._)("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":e[3]||(e[3]=t=>s.tempCoupon.percent=t),placeholder:"請輸入折扣百分比"},null,512),[[b.nr,s.tempCoupon.percent,void 0,{number:!0}]])]),(0,n._)("div",G,[(0,n._)("div",W,[(0,n.wy)((0,n._)("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[4]||(e[4]=t=>s.tempCoupon.is_enabled=t)},null,512),[[b.e8,s.tempCoupon.is_enabled]]),Z])])]),(0,n._)("div",z,[O,s.tempCoupon.id?((0,n.wg)(),(0,n.iD)("button",{key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[5]||(e[5]=(...t)=>l.editCoupon&&l.editCoupon(...t))}," 確認編輯 ")):((0,n.wg)(),(0,n.iD)("button",{key:1,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[6]||(e[6]=(...t)=>l.addCoupon&&l.addCoupon(...t))}," 確認新增 "))])])])],512)}var J=o(7424),N=o.n(J),T={name:"CouponModal",emits:["get-coupons"],props:{coupon:{}},data(){return{modal:{},tempCoupon:{},due_date:""}},watch:{coupon(){this.tempCoupon=this.coupon;const t=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=t},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{addCoupon(){this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ycl/admin/coupon",{data:this.tempCoupon}).then((t=>{this.$httpMessageState(t,"新增優惠券"),this.$emit("get-coupons",this.currentPage)})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},editCoupon(){this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ycl/admin/coupon/${this.tempCoupon.id}`,{data:this.tempCoupon}).then((t=>{this.$httpMessageState(t,"編輯優惠券"),this.$emit("get-coupons",this.currentPage)})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))}},mounted(){this.modal=new(N())(this.$refs.couponModal)}},Y=o(3744);const K=(0,Y.Z)(T,[["render",H]]);var j=K,q=o(9689),A=o(3794),B={data(){return{coupons:[],tempCoupon:{},pagination:{},currentPage:1,isLoading:!1}},components:{PaginationComponent:A.Z,CouponModal:j,DeleteModal:q.Z},methods:{getCoupons(t=1){this.isLoading=!0,this.currentPage=t,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/ycl/admin/coupons/?page=${t}`).then((t=>{this.coupons=t.data.coupons,this.pagination=t.data.pagination,this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息"),this.isLoading=!1}))},openCouponModal(t){this.isLoading=!0,this.tempCoupon=JSON.parse(JSON.stringify(t)),this.isLoading=!1},openDeleteModal(t){this.isLoading=!0,this.tempCoupon=t,this.isLoading=!1},deleteCoupon(){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ycl/admin/coupon/${this.tempCoupon.id}`).then((t=>{this.$httpMessageState(t,"刪除優惠券"),this.getCoupons(),this.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"刪除優惠券"),this.isLoading=!1}))}},mounted(){this.getCoupons()}};const E=(0,Y.Z)(B,[["render",g]]);var F=E}}]);
//# sourceMappingURL=750.26c6f820.js.map